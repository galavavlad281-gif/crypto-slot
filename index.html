<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Slot Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3em;
            background: linear-gradient(45deg, #ffd700, #ff8c00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .header p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9em;
        }

        .login-screen {
            background: #1a1a2e;
            border-radius: 20px;
            padding: 40px;
        }

        .login-screen h2 {
            margin-bottom: 25px;
            text-align: center;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.7);
        }

        .form-input {
            padding: 12px;
            border: 2px solid #2d2d44;
            border-radius: 8px;
            background: #2d2d44;
            color: white;
            font-size: 1em;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            margin-top: 10px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .error-message {
            color: #ef4444;
            font-size: 0.9em;
            text-align: center;
            margin-top: 10px;
        }

        .game-screen {
            display: none;
        }

        .user-info {
            background: #1a1a2e;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-details {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-role {
            font-weight: bold;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .user-role.admin {
            background: #ef4444;
        }

        .user-role.user {
            background: #10b981;
        }

        .user-name {
            font-size: 1.1em;
            font-weight: bold;
        }

        .logout-btn {
            padding: 8px 20px;
            background: #2d2d44;
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .logout-btn:hover {
            background: #3d3d54;
        }

        .admin-panel {
            background: #1a1a2e;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid #ef4444;
        }

        .admin-panel h3 {
            margin-bottom: 20px;
            color: #ef4444;
        }

        .admin-section {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .admin-section h4 {
            font-size: 1em;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.8);
        }

        .admin-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .admin-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #2d2d44;
            border-radius: 8px;
            background: #2d2d44;
            color: white;
            font-size: 1em;
        }

        .admin-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .admin-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .admin-btn.add {
            background: #10b981;
            color: white;
        }

        .admin-btn.reset {
            background: #ef4444;
            color: white;
        }

        .admin-btn.create {
            background: #667eea;
            color: white;
        }

        .admin-btn:hover {
            opacity: 0.8;
        }

        .user-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .user-item {
            background: #2d2d44;
            border-radius: 8px;
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-item-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .user-item-name {
            font-weight: bold;
        }

        .user-item-password {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.6);
        }

        .user-item-balance {
            color: #ffd700;
            font-weight: bold;
        }

        .delete-btn {
            padding: 8px 15px;
            background: #ef4444;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-size: 0.9em;
        }

        .delete-btn:hover {
            opacity: 0.8;
        }

        .user-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #2d2d44;
            border-radius: 8px;
            background: #2d2d44;
            color: white;
            font-size: 1em;
            margin-bottom: 10px;
        }

        .user-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .wallet {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .wallet-address {
            font-size: 0.85em;
            opacity: 0.8;
            margin-bottom: 10px;
            word-break: break-all;
        }

        .balance {
            font-size: 2em;
            font-weight: bold;
            text-align: right;
        }

        .balance-label {
            font-size: 0.5em;
            opacity: 0.8;
        }

        .slot-machine {
            background: #1a1a2e;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
        }

        .slots {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .slot {
            width: 100px;
            height: 100px;
            background: linear-gradient(180deg, #2d2d44, #1a1a2e);
            border: 4px solid #ffd700;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4em;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .slot.spinning {
            animation: pulse 0.3s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .message {
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 20px;
            min-height: 30px;
        }

        .message.win {
            color: #4ade80;
        }

        .message.info {
            color: rgba(255, 255, 255, 0.6);
        }

        .message.error {
            color: #ef4444;
        }

        .bet-controls {
            margin-bottom: 25px;
        }

        .bet-controls label {
            display: block;
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 10px;
        }

        .bet-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .bet-button {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.2s;
            background: #2d2d44;
            color: white;
        }

        .bet-button.active {
            background: #ffd700;
            color: black;
        }

        .bet-button:hover:not(.active) {
            background: #3d3d54;
        }

        .spin-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.4);
        }

        .spin-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6);
        }

        .spin-button:disabled {
            background: #4b5563;
            cursor: not-allowed;
            box-shadow: none;
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: #1a1a2e;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-card.win {
            border-color: rgba(74, 222, 128, 0.3);
        }

        .stat-card.loss {
            border-color: rgba(239, 68, 68, 0.3);
        }

        .stat-card.deposit {
            border-color: rgba(255, 215, 0, 0.3);
        }

        .stat-label {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
        }

        .stat-value.win {
            color: #4ade80;
        }

        .stat-value.loss {
            color: #ef4444;
        }

        .stat-value.deposit {
            color: #ffd700;
        }

        .history {
            background: #1a1a2e;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .history h3 {
            margin-bottom: 15px;
        }

        .history-item {
            background: #2d2d44;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
        }

        .history-empty {
            text-align: center;
            color: rgba(255, 255, 255, 0.4);
            padding: 20px 0;
        }

        .paytable {
            background: #1a1a2e;
            border-radius: 12px;
            padding: 20px;
        }

        .paytable h3 {
            text-align: center;
            margin-bottom: 15px;
        }

        .paytable-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .paytable-item {
            background: #2d2d44;
            border-radius: 8px;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .paytable-symbols {
            font-size: 1.3em;
        }

        .paytable-multiplier {
            color: #ffd700;
            font-weight: bold;
        }

        .paytable-note {
            text-align: center;
            font-size: 0.75em;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 10px;
        }

        .paytable-warning {
            text-align: center;
            font-size: 0.8em;
            color: #ef4444;
            padding: 10px;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé∞ CRYPTO SLOTS</h1>
            <p>–°–∏–º—É–ª—è—Ç–æ—Ä ‚Ä¢ –ë–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–µ–Ω–µ–≥</p>
        </div>

        <div class="login-screen" id="loginScreen">
            <h2>üîê –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <form class="login-form" onsubmit="login(event)">
                <div class="form-group">
                    <label>–õ–æ–≥–∏–Ω</label>
                    <input type="text" class="form-input" id="loginUsername" required>
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-input" id="loginPassword" required>
                </div>
                <button type="submit" class="login-btn">–í–æ–π—Ç–∏</button>
                <div class="error-message" id="loginError"></div>
            </form>
        </div>

        <div class="game-screen" id="gameScreen">
            <div class="user-info">
                <div class="user-details">
                    <span class="user-role" id="userRole"></span>
                    <span class="user-name" id="userName"></span>
                </div>
                <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>

            <div class="admin-panel" id="adminPanel" style="display: none;">
                <h3>üëë –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                
                <div class="admin-section">
                    <h4>–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h4>
                    <div class="admin-controls">
                        <input type="text" class="admin-input" id="newUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                        <input type="text" class="admin-input" id="newPassword" placeholder="–ü–∞—Ä–æ–ª—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: admin)">
                        <button class="admin-btn create" onclick="createUser()">‚ûï –°–æ–∑–¥–∞—Ç—å</button>
                    </div>
                </div>

                <div class="admin-section">
                    <h4>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–º</h4>
                    <select class="user-select" id="selectedUser">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
                    </select>
                    <div class="admin-controls">
                        <input type="number" class="admin-input" id="adminAmount" placeholder="–°—É–º–º–∞ USDT" min="0" step="10">
                        <button class="admin-btn add" onclick="addBalance()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                        <button class="admin-btn reset" onclick="resetUserBalance()">üóëÔ∏è –û–±–Ω—É–ª–∏—Ç—å</button>
                    </div>
                </div>

                <div class="admin-section">
                    <h4>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h4>
                    <div class="user-list" id="userList"></div>
                </div>
            </div>

            <div class="wallet">
                <div class="wallet-address" id="walletAddress"></div>
                <div class="balance">
                    <span id="balance">0.00</span> USDT
                    <div class="balance-label">–ë–∞–ª–∞–Ω—Å</div>
                </div>
            </div>

            <div class="slot-machine">
                <div class="slots">
                    <div class="slot" id="slot1">üçã</div>
                    <div class="slot" id="slot2">üçí</div>
                    <div class="slot" id="slot3">üçä</div>
                </div>

                <div class="message" id="message"></div>

                <div class="bet-controls">
                    <label>–°—Ç–∞–≤–∫–∞ (USDT)</label>
                    <div class="bet-buttons">
                        <button class="bet-button active" onclick="setBet(10)">10</button>
                        <button class="bet-button" onclick="setBet(25)">25</button>
                        <button class="bet-button" onclick="setBet(50)">50</button>
                        <button class="bet-button" onclick="setBet(100)">100</button>
                    </div>
                </div>

                <button class="spin-button" id="spinButton" onclick="spin()">
                    üé∞ –ö–†–£–¢–ò–¢–¨
                </button>
            </div>

            <div class="stats">
                <div class="stat-card deposit">
                    <div class="stat-label">–í–Ω–µ—Å–µ–Ω–æ</div>
                    <div class="stat-value deposit"><span id="totalDeposit">0.00</span> USDT</div>
                </div>
                <div class="stat-card win">
                    <div class="stat-label">–í—ã–∏–≥—Ä–∞–Ω–æ</div>
                    <div class="stat-value win"><span id="totalWon">0.00</span> USDT</div>
                </div>
                <div class="stat-card loss">
                    <div class="stat-label">–ü—Ä–æ–∏–≥—Ä–∞–Ω–æ</div>
                    <div class="stat-value loss"><span id="totalLost">0.00</span> USDT</div>
                </div>
            </div>

            <div class="history">
                <h3>–ò—Å—Ç–æ—Ä–∏—è —Å–ø–∏–Ω–æ–≤</h3>
                <div id="historyList">
                    <div class="history-empty">–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏</div>
                </div>
            </div>

            <div class="paytable">
                <h3>–¢–∞–±–ª–∏—Ü–∞ –≤—ã–ø–ª–∞—Ç (–º–Ω–æ–∂–∏—Ç–µ–ª—å √ó —Å—Ç–∞–≤–∫–∞)</h3>
                <div class="paytable-grid">
                    <div class="paytable-item">
                        <span class="paytable-symbols">7Ô∏è‚É£ 7Ô∏è‚É£ 7Ô∏è‚É£</span>
                        <span class="paytable-multiplier">√ó50</span>
                    </div>
                    <div class="paytable-item">
                        <span class="paytable-symbols">üíé üíé üíé</span>
                        <span class="paytable-multiplier">√ó30</span>
                    </div>
                    <div class="paytable-item">
                        <span class="paytable-symbols">‚≠ê ‚≠ê ‚≠ê</span>
                        <span class="paytable-multiplier">√ó20</span>
                    </div>
                    <div class="paytable-item">
                        <span class="paytable-symbols">üçä üçä üçä</span>
                        <span class="paytable-multiplier">√ó10</span>
                    </div>
                    <div class="paytable-item">
                        <span class="paytable-symbols">üçí üçí üçí</span>
                        <span class="paytable-multiplier">√ó8</span>
                    </div>
                    <div class="paytable-item">
                        <span class="paytable-symbols">üçã üçã üçã</span>
                        <span class="paytable-multiplier">√ó5</span>
                    </div>
                </div>
                <div class="paytable-note">–î–≤–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ: √ó2</div>
                <div class="paytable-warning">‚ö†Ô∏è –®–∞–Ω—Å –≤—ã–∏–≥—Ä—ã—à–∞ ~5% | RTP –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ</div>
            </div>
        </div>
    </div>

    <script>
        const SYMBOLS = ['üçã', 'üçí', 'üçä', 'üíé', '‚≠ê', '7Ô∏è‚É£'];
        const SYMBOL_VALUES = {
            '7Ô∏è‚É£': 50,
            'üíé': 30,
            '‚≠ê': 20,
            'üçä': 10,
            'üçí': 8,
            'üçã': 5
        };

        const SYMBOL_WEIGHTS = {
            'üçã': 35,
            'üçí': 30,
            'üçä': 20,
            'üíé': 10,
            '‚≠ê': 4,
            '7Ô∏è‚É£': 1
        };

        let users = {
            admin: {
                password: 'qqAA',
                role: 'admin',
                balance: 0,
                totalWon: 0,
                totalLost: 0,
                totalDeposit: 0,
                history: [],
                wallet: ''
            }
        };

        let currentUser = null;
        let bet = 10;
        let spinning = false;

        function generateWallet() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let addr = 'T';
            for (let i = 0; i < 33; i++) {
                addr += chars[Math.floor(Math.random() * chars.length)];
            }
            return addr;
        }

        function login(event) {
            event.preventDefault();
            
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const errorEl = document.getElementById('loginError');

            if (!users[username]) {
                errorEl.textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω';
                return;
            }

            if (users[username].password !== password) {
                errorEl.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å';
                return;
            }

            currentUser = username;
            
            if (!users[username].wallet) {
                users[username].wallet = generateWallet();
            }

            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            
            const roleEl = document.getElementById('userRole');
            const nameEl = document.getElementById('userName');
            
            nameEl.textContent = username;
            
            if (users[username].role === 'admin') {
                roleEl.textContent = 'üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä';
                roleEl.className = 'user-role admin';
                document.getElementById('adminPanel').style.display = 'block';
                updateUserList();
                updateUserSelect();
            } else {
                roleEl.textContent = 'üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                roleEl.className = 'user-role user';
                document.getElementById('adminPanel').style.display = 'none';
            }

            document.getElementById('walletAddress').textContent = 'TRC20: ' + users[username].wallet;
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
            errorEl.textContent = '';
            
            updateDisplay();
            updateHistory();
        }

        function logout() {
            currentUser = null;
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('gameScreen').style.display = 'none';
        }

        function createUser() {
            if (users[currentUser].role !== 'admin') return;

            const username = document.getElementById('newUsername').value.trim();
            let password = document.getElementById('newPassword').value.trim();
            
            if (!password) password = 'admin';

            if (!username) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
                return;
            }

            if (users[username]) {
                showMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                return;
            }

            users[username] = {
                password: password,
                role: 'user',
                balance: 0,
                totalWon: 0,
                totalLost: 0,
                totalDeposit: 0,
                history: [],
                wallet: generateWallet()
            };

            showMessage(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —Å–æ–∑–¥–∞–Ω`, 'win');
            document.getElementById('newUsername').value = '';
            document.getElementById('newPassword').value = '';
            
            updateUserList();
            updateUserSelect();
        }

        function updateUserList() {
            const listEl = document.getElementById('userList');
            const userList = Object.keys(users).filter(u => users[u].role === 'user');

            if (userList.length === 0) {
                listEl.innerHTML = '<div class="history-empty">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>';
                return;
            }

            listEl.innerHTML = userList.map(username => `
                <div class="user-item">
                    <div class="user-item-info">
                        <div class="user-item-name">üë§ ${username}</div>
                        <div class="user-item-password">–ü–∞—Ä–æ–ª—å: ${users[username].password}</div>
                        <div class="user-item-balance">–ë–∞–ª–∞–Ω—Å: ${users[username].balance.toFixed(2)} USDT</div>
                    </div>
                    <button class="delete-btn" onclick="deleteUser('${username}')">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            `).join('');
        }

        function updateUserSelect() {
            const selectEl = document.getElementById('selectedUser');
            const userList = Object.keys(users).filter(u => users[u].role === 'user');

            selectEl.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>' + 
                userList.map(username => `<option value="${username}">${username} (${users[username].balance.toFixed(2)} USDT)</option>`).join('');
        }

        function deleteUser(username) {
            if (confirm(`–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${username}?`)) {
                delete users[username];
                showMessage(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —É–¥–∞–ª–µ–Ω`, 'info');
                updateUserList();
                updateUserSelect();
            }
        }

        function addBalance() {
            if (users[currentUser].role !== 'admin') return;

            const selectedUser = document.getElementById('selectedUser').value;
            const amount = parseFloat(document.getElementById('adminAmount').value);

            if (!selectedUser) {
                showMessage('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
                return;
            }

            if (isNaN(amount) || amount <= 0) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É', 'error');
                return;
            }

            users[selectedUser].balance += amount;
            users[selectedUser].totalDeposit += amount;
            
            showMessage(`–ë–∞–ª–∞–Ω—Å ${selectedUser} –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount.toFixed(2)} USDT`, 'win');
            document.getElementById('adminAmount').value = '';
            
            updateUserList();
            updateUserSelect();
        }

        function resetUserBalance() {
            if (users[currentUser].role !== 'admin') return;

            const selectedUser = document.getElementById('selectedUser').value;

            if (!selectedUser) {
                showMessage('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
                return;
            }

            users[selectedUser].balance = 0;
            users[selectedUser].totalWon = 0;
            users[selectedUser].totalLost = 0;
            users[selectedUser].totalDeposit = 0;
            users[selectedUser].history = [];

            showMessage(`–ë–∞–ª–∞–Ω—Å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ${selectedUser} —Å–±—Ä–æ—à–µ–Ω—ã`, 'info');
            updateUserList();
            updateUserSelect();
            if (selectedUser === currentUser) {
                updateDisplay();
                updateHistory();
            }
        }

        // === –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò ===

        function setBet(amount) {
            bet = amount;
            document.querySelectorAll('.bet-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function getRandomSymbol() {
            const totalWeight = Object.values(SYMBOL_WEIGHTS).reduce((a, b) => a + b, 0);
            let random = Math.random() * totalWeight;
            for (const symbol of SYMBOLS) {
                if (random < SYMBOL_WEIGHTS[symbol]) {
                    return symbol;
                }
                random -= SYMBOL_WEIGHTS[symbol];
            }
            return SYMBOLS[0];
        }

        function calculateWin(s1, s2, s3) {
            if (s1 === s2 && s2 === s3) {
                return bet * SYMBOL_VALUES[s1];
            } else if (s1 === s2 || s2 === s3 || s1 === s3) {
                return bet * 2;
            }
            return 0;
        }

        function showMessage(text, type = 'info') {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.className = 'message ' + type;
            setTimeout(() => {
                if (msg.textContent === text) msg.textContent = '';
            }, 3000);
        }

        function updateDisplay() {
            const user = users[currentUser];
            document.getElementById('balance').textContent = user.balance.toFixed(2);
            document.getElementById('totalDeposit').textContent = user.totalDeposit.toFixed(2);
            document.getElementById('totalWon').textContent = user.totalWon.toFixed(2);
            document.getElementById('totalLost').textContent = user.totalLost.toFixed(2);
        }

        function updateHistory() {
            const list = document.getElementById('historyList');
            const user = users[currentUser];
            if (user.history.length === 0) {
                list.innerHTML = '<div class="history-empty">–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏</div>';
                return;
            }
            list.innerHTML = user.history.slice().reverse().map(item => `
                <div class="history-item">
                    <span>${item.time}</span>
                    <span>${item.result > 0 ? '+' : ''}${item.result.toFixed(2)} USDT</span>
                </div>
            `).join('');
        }

        async function spin() {
            if (spinning) return;
            const user = users[currentUser];
            if (user.balance < bet) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤', 'error');
                return;
            }

            spinning = true;
            user.balance -= bet;
            user.totalLost += bet;
            updateDisplay();

            const spinButton = document.getElementById('spinButton');
            spinButton.disabled = true;

            // –ê–Ω–∏–º–∞—Ü–∏—è
            const slots = [document.getElementById('slot1'), document.getElementById('slot2'), document.getElementById('slot3')];
            slots.forEach(slot => slot.classList.add('spinning'));

            // –°–∏–º—É–ª—è—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
            let spins = 0;
            const maxSpins = 10;
            const interval = setInterval(() => {
                slots.forEach(slot => {
                    slot.textContent = getRandomSymbol();
                });
                spins++;
                if (spins >= maxSpins) {
                    clearInterval(interval);
                    finishSpin();
                }
            }, 100);

            function finishSpin() {
                slots.forEach(slot => slot.classList.remove('spinning'));
                const s1 = getRandomSymbol();
                const s2 = getRandomSymbol();
                const s3 = getRandomSymbol();
                slots[0].textContent = s1;
                slots[1].textContent = s2;
                slots[2].textContent = s3;

                const win = calculateWin(s1, s2, s3);
                const time = new Date().toLocaleTimeString();

                if (win > 0) {
                    user.balance += win;
                    user.totalWon += win;
                    showMessage(`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${win.toFixed(2)} USDT!`, 'win');
                } else {
                    showMessage('–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞!', 'info');
                }

                user.history.push({ time, result: win - bet });
                if (user.history.length > 10) user.history.shift();

                updateDisplay();
                updateHistory();
                spinning = false;
                spinButton.disabled = false;
            }
        }
    </script>
</body>
</html>
